import{t as L,a as A,e as Z,s as H}from"../chunks/B_ag6RmW.js";import{i as be}from"../chunks/BLXaI5_v.js";import{G as dt,W as ct,s as ye,ax as Pe,w as Ce,x as r,y as a,ay as se,z as S,F as T,az as le,aA as Be,v as R,aB as M,_ as Ue,l as d,u as F,aC as ft,ad as Fe,m as Ye,e as Me,ab as ut}from"../chunks/BvSNCPWU.js";import{r as q,S as _e,m as vt,a as pt,b as mt,t as gt,s as xt,g as ht,c as K,d as ve,e as wt,f as _t,h as Oe,i as bt,n as yt,j as Ct,k as qe,l as St,o as Ke,p as $e,q as Te,u as Qe,v as kt,w as $t,x as Tt,y as jt,z as Et,A as Pt,B as It,C as He,D as Dt,E as Xe,F as Ft}from"../chunks/Bm0hMJPM.js";import{b as Le}from"../chunks/CiIBqmdd.js";import{i as oe,s as Ie,b as O,c as we,d as ae,p as ue}from"../chunks/B3tenwui.js";function Y(s,n,e,v){var t=s.__styles??(s.__styles={});t[n]!==e&&(t[n]=e,e==null?s.style.removeProperty(n):s.style.setProperty(n,e,""))}function Ee(s,n,e){var v=dt(s,n);v&&v.set&&(s[n]=e,ct(()=>{s[n]=null}))}var Mt=L('<div class="bg-white font-semibold text-white text-xl w-full flex min-h-[4rem] rounded-t-lg overflow-hidden" style="box-shadow: 0 -2px 8px #777;"><button type="button" class="bg-rose-600 w-1/3 overflow-hidden items-center justify-items-center justify-center p-2 active:!text-error-700 active:bg-white flex space-x-2"><span class="w-5"><!></span> <span>WRONG</span></button> <button type="button" class="bg-slate-600 w-1/3 overflow-hidden items-center justify-items-center justify-center p-2 active:!text-secondary-700 active:bg-white flex space-x-2"><span class="w-5"><!></span> <span>SKIP</span></button> <button type="button" class="bg-green-600 w-1/3 overflow-hidden items-center justify-items-center justify-center p-2 active:!text-success-700 active:bg-white flex space-x-2"><span class="w-5"><!></span> <span>FINE</span></button></div>'),Ht=L("<div><!></div>");function At(s,n){ye(n,!1);const[e,v]=Ie(),t=()=>O(q,"$roundState",e),i=Pe();function o(){i("answerWrong",{})}function k(){i("answerSkipped",{})}function l(){i("answerFine",{})}be();var f=Ht(),p=r(f);{var m=h=>{var y=Mt(),w=r(y),j=r(w),c=r(j);_e(c,{d:vt}),a(j),se(2),a(w);var E=S(w,2),_=r(E),P=r(_);_e(P,{d:pt}),a(_),se(2),a(E);var $=S(E,2),I=r($),z=r(I);_e(z,{d:mt}),a(I),se(2),a($),a(y),Z("click",w,o),Z("click",E,k),Z("click",$,l),gt(3,y,()=>xt,()=>({axis:"x"})),A(h,y)},x=h=>{};oe(p,h=>{t().hasStarted?h(m):h(x,!1)})}a(f),A(s,f),Ce(),v()}var Lt=L('<div class="bg-white rounded-none font-semibold w-full shadow-lg flex justify-between rounded-b-lg overflow-hidden"><div><button class="btn bg-teal-600 text-white rounded-none h-full px-3"><span class="w-6 p-0"><!></span></button></div> <div class="h-full w-full relative"><div class=" w-full h-[calc(100%_-_12px)] flex justify-between items-center"><div class="flex place-items-center w-full pl-2 space-x-2"><span class="small-caps">Team</span> <span class="text-xl tabular-nums"> </span></div> <div class="flex place-items-center justify-end w-full px-2 space-x-2"><span class="text-2xl text-right tabular-nums w-[2ch]"> </span> <span class="small-caps">Points</span></div></div> <div class="absolute bottom-0 -left-px right-0"><div>Time</div></div></div> <div class="flex flex-nowrap space-x-1 shrink-0"><button type="button" class="bg-teal-600 items-center justify-center px-2 active:!text-success-700 active:bg-white flex space-x-1 text-white"><span class="w-5"><!></span> <span>End Round</span></button></div></div>');function zt(s,n){ye(n,!1);const[e,v]=Ie(),t=()=>O(q,"$roundState",e),i=()=>O(Oe,"$settings",e),o=()=>O(ve,"$gameState",e),k=Pe();let l=M(0),f=M(new Date("2999-12-12")),p=M(0);function m(){T(p,t().pointsEarned),we(q,bt(i())),ae(q,F(t).oldPointsEarned=d(p),F(t)),ae(ve,F(o).currentTeam=yt(o().currentTeam),F(o)),T(f,new Date)}function x(){const W={type:"component",component:"settingsModal"};Ct.trigger(W)}setInterval(()=>{T(f,new Date)},200);let h=M(1);le(()=>(t(),d(l),d(f),i()),()=>{t().hasStarted?T(l,Math.min(t().totalSeconds,Math.max(t().totalSeconds-Math.floor((d(f).getTime()-t().startTime.getTime())/1e3),0))):T(l,t().totalSeconds),T(h,Math.max(0,Math.min(1,d(l)/i().secondsPerRound))),d(l)<=0&&(k("timeOut",{}),m())}),Be(),be();var y=Lt(),w=r(y),j=r(w),c=r(j),E=r(c);_e(E,{d:wt}),a(c),a(j),a(w);var _=S(w,2),P=r(_),$=r(P),I=r($),z=S(I,2),X=r(z,!0);a(z),a($);var J=S($,2),ee=r(J),de=r(ee,!0);a(ee),se(2),a(J),a(P);var ne=S(P,2),g=r(ne);let ce;a(ne),a(_);var u=S(_,2),G=r(u),Q=r(G),te=r(Q);_e(te,{d:_t}),a(Q),se(2),a(G),a(u),a(y),R(W=>{Y(I,"color",W),Y(z,"color",W),H(X,o().currentTeam),H(de,t().hasStarted?t().pointsEarned:d(p)),ce=K(g,1,"h-3 bg-slate-600 transition-all text-white text-[0.5em] w-full ease-in leading-3 uppercase tracking-widest px-1",null,ce,{"bg-red-700":+d(l)<11}),Y(g,"width",d(h)*100+"%")},[()=>ht(o().currentTeam)],Ue),Z("click",j,x),Z("click",G,m),A(s,y),Ce(),v()}const Bt=300,Ve="none";function he(s,n,e){return s.addEventListener(n,e),()=>s.removeEventListener(n,e)}function Ut(s,n){return n.filter(e=>s.pointerId!==e.pointerId)}function je(s,n,e,v,t){s.dispatchEvent(new CustomEvent(`${n}${t}`,{detail:{event:e,pointersCount:v.length,target:e.target}}))}function Ot(s,n,e,v,t,i=Ve){n.style.touchAction=i;let o=[];function k(f){o.push(f),je(n,s,f,o,"down"),v==null||v(o,f);const p=f.pointerId;function m(c){p===c.pointerId&&(o=Ut(c,o),o.length||x(),je(n,s,c,o,"up"))}function x(){h(),y(),w(),j()}const h=he(n,"pointermove",c=>{o=o.map(E=>c.pointerId===E.pointerId?c:E),je(n,s,c,o,"move"),e==null||e(o,c)}),y=he(n,"lostpointercapture",c=>{m(c)}),w=he(n,"pointerup",c=>{m(c)}),j=he(n,"pointerleave",c=>{o=[],x(),je(n,s,c,o,"up")})}const l=he(n,"pointerdown",k);return{destroy:()=>{l()}}}function Ae(s,n){let e={delay:Bt,composed:!1,touchAction:Ve,...n};const v="pan";let t,i;function o(l,f){t=Date.now(),i=f.target}function k(l,f){if(l.length===1&&Date.now()-t>e.delay){const p=s.getBoundingClientRect(),m=Math.round(f.clientX-p.left),x=Math.round(f.clientY-p.top);m>=0&&x>=0&&m<=p.width&&x<=p.height&&s.dispatchEvent(new CustomEvent(v,{detail:{x:m,y:x,target:i}}))}return!1}return e.composed?{onMove:k,onDown:o,onUp:null}:{...Ot(v,s,k,o,null,e.touchAction),update:l=>{e={...e,...l}}}}function Je(s){return Object.prototype.toString.call(s)==="[object Date]"}function ze(s,n,e,v){if(typeof e=="number"||Je(e)){const t=v-e,i=(e-n)/(s.dt||1/60),o=s.opts.stiffness*t,k=s.opts.damping*i,l=(o-k)*s.inv_mass,f=(i+l)*s.dt;return Math.abs(f)<s.opts.precision&&Math.abs(t)<s.opts.precision?v:(s.settled=!1,Je(e)?new Date(e.getTime()+f):e+f)}else{if(Array.isArray(e))return e.map((t,i)=>ze(s,n[i],e[i],v[i]));if(typeof e=="object"){const t={};for(const i in e)t[i]=ze(s,n[i],e[i],v[i]);return t}else throw new Error(`Cannot spring ${typeof e} values`)}}function Rt(s,n={}){const e=ft(s),{stiffness:v=.15,damping:t=.8,precision:i=.01}=n;let o,k,l,f=s,p=s,m=1,x=0,h=!1;function y(j,c={}){p=j;const E=l={};return s==null||c.hard||w.stiffness>=1&&w.damping>=1?(h=!0,o=qe.now(),f=j,e.set(s=p),Promise.resolve()):(c.soft&&(x=1/((c.soft===!0?.5:+c.soft)*60),m=0),k||(o=qe.now(),h=!1,k=St(_=>{if(h)return h=!1,k=null,!1;m=Math.min(m+x,1);const P=Math.min(_-o,1e3/30),$={inv_mass:m,opts:w,settled:!0,dt:P*60/1e3},I=ze($,f,s,p);return o=_,f=s,e.set(s=I),$.settled&&(k=null),!$.settled})),new Promise(_=>{k.promise.then(()=>{E===l&&_()})}))}const w={set:y,update:(j,c)=>y(j(p,s),c),subscribe:e.subscribe,stiffness:v,damping:t,precision:i};return w}var Nt=L("<div><div><div><!></div> <div><!></div></div></div>");function Gt(s,n){ye(n,!1);let e=ue(n,"containerCardClass",8,""),v=ue(n,"containerCardInnerClass",8,""),t=ue(n,"frontCardClass",8,""),i=ue(n,"backCardClass",8,""),o=ue(n,"isUp",12,!1);const k=Pe();let l=M(!0);async function f(){return new Promise(async(_,P)=>{T(l,!1),await Fe(),o(!1),await Fe(),setTimeout(()=>{T(l,!0),o(!0),_()},10)})}async function p(){return new Promise(async(_,P)=>{o()&&(o(!1),await Fe())})}function m(_){k("tapCard",{type:o()?"front":"back"})}be();var x=Nt(),h=r(x);let y;var w=r(h),j=r(w);Ke(j,n,"front",{},null),a(w);var c=S(w,2),E=r(c);return Ke(E,n,"back",{},null),a(c),a(h),a(x),R((_,P,$,I)=>{K(x,1,Te(_),"svelte-1fd8m2h"),y=K(h,1,Te(P),"svelte-1fd8m2h",y,{enableTransition:d(l),flipped:!o()}),K(w,1,Te($),"svelte-1fd8m2h"),K(c,1,Te(I),"svelte-1fd8m2h")},[()=>$e(e(),"container-card drop-shadow-md"),()=>$e(v(),"container-card-inner relative w-full h-full transform"),()=>$e(t(),"front-card  w-full h-full backface-invisible"),()=>$e(i(),"back-card absolute inset-0 backface-invisible")],Ue),Z("pointerdown",h,m),Z("click",x,function(_){Qe.call(this,n,_)}),A(s,x),Ee(n,"flipFromBack",f),Ee(n,"flipToBack",p),Ce({flipFromBack:f,flipToBack:p})}var Wt=L('<div class="py-2 font-medium text-center text-xl svelte-2jg59n"> </div>'),Yt=L('<div class="py-2 font-medium text-center text-xl svelte-2jg59n"> </div>'),qt=L('<div class="svelte-2jg59n"><div class="text-center text-2xl"> </div> <div class="-mt-1 text-center text-sm"> </div></div>'),Kt=L('<div class="text-center text-md"> </div>'),Xt=L('<div class="text-center text-md"> </div>'),Jt=L('<div class="w-full self-center"><div class="text-center text-xl"> </div> <div class="-mt-1 text-center text-xs"> </div></div>'),Qt=L('<div class="flex align-middle justify-center p-0 min-h-[2em] max-h-[6em] h-full"><div><!> <!></div> <!></div>'),Vt=L('<div slot="front"><div class="rounded-md border-2 relative h-full"><div class="flex w-full -top-4 left-0 absolute justify-center"><div class="rounded-full font-medium text-white text-sm tracking-wider py-1 px-2 capitalize"> </div></div> <div class="absolute right-2 -top-4 bg-white ml-1 font-medium text-center rounded-full border-2 text-sm tracking-wider py-1 px-2 capitalize"> </div> <div class="flex flex-col h-full"><div class="flex basis-0 flex-col space-y-2 w-full h-full min-h-[8em] my-4 target-word items-center justify-center tracking-wider leading-4"><div class="w-full target-words svelte-2jg59n"><!> <!> <!></div></div> <div class="forbidden-words grow tracking-wider leading-4 h-full flex flex-col"></div></div></div></div>'),Zt=L(`<div slot="back"><div><div class="h-full w-full flex flex-col space-y-5 place-items-center pt-16 text-secondary-800"><div class="bg-white/70 text-4xl p-4 rounded-lg self-center font-semibold border-2 border-blue-400">You scored <span class="font-black text-red-800"> </span> points!</div> <div class="bg-white/70 text-4xl p-4 rounded-lg self-center font-semibold border-2 border-blue-400">Team <span class="font-black text-red-800"> </span>'s turn!</div></div></div></div>`),ea=L('<div class="grow relative"><!> <div><span class="whitespace-pre"> </span></div> <div class="bg-white rounded-lg shadow-sm p-4 pt-6 shadow-slate-500 transform translate-x-0 select-none origin-bottom absolute inset-3 -z-10 back-card svelte-2jg59n"></div></div>');function ta(s,n){ye(n,!1);const[e,v]=Ie(),t=()=>O(x,"$cardTouchDelta",e),i=()=>O(q,"$roundState",e),o=()=>O(Oe,"$settings",e),k=()=>O(ve,"$gameState",e);let l=ue(n,"currentCard",12),f=M("");const p=Pe(),m={start:{x:0,y:0}},x=Rt({x:0,y:0}),h=60;let y=M(),w=M();function j(g){d(y).releasePointerCapture(g.detail.event.pointerId),Math.abs(t().x)>h?(t().x<0&&p("answerSkipped",{}),t().x>0&&p("answerFine",{}),x.set({x:0,y:0},{hard:!0})):x.set({x:0,y:0})}function c(g){x.set({x:g.detail.event.x-m.start.x,y:g.detail.event.y-m.start.y})}function E(g){i().hasStarted&&(d(y).setPointerCapture(g.detail.event.pointerId),m.start={x:g.detail.event.x,y:g.detail.event.y})}async function _(){return d(w).flipFromBack()}async function P(){var g;return(g=d(w))==null?void 0:g.flipToBack()}let $=M(!1);le(()=>Ye(l()),()=>{l()||l({category:"none",categoryColor:"#333",difficulty:1,word:{en:"",de:"",zh:"",pinyin:""},forbidden:[]})}),le(()=>Ye(l()),()=>{l()&&T(f,l().difficulty===1?"easy":l().difficulty===2?"medium":"hard")}),le(()=>(d($),i()),()=>{!d($)&&!i().hasStarted&&P()}),Be(),be();var I=ea(),z=r(I);Le(Gt(z,{containerCardClass:"absolute inset-3",get isUp(){return d($)},set isUp(g){T($,g)},$$events:{tapCard(g){Qe.call(this,n,g)}},$$slots:{front:(g,ce)=>{var u=Vt();let G;var Q=r(u),te=r(Q),W=r(te),pe=r(W,!0);a(W),a(te);var re=S(te,2),De=r(re,!0);a(re);var me=S(re,2),fe=r(me),ge=r(fe),Re=r(ge);{var Ze=C=>{var b=Wt(),N=r(b,!0);a(b),R(()=>{var D;return H(N,(D=l())==null?void 0:D.word.de)}),A(C,b)};oe(Re,C=>{o().languages.german&&C(Ze)})}var Ne=S(Re,2);{var et=C=>{var b=Yt(),N=r(b,!0);a(b),R(()=>{var D;return H(N,(D=l())==null?void 0:D.word.en)}),A(C,b)};oe(Ne,C=>{o().languages.english&&C(et)})}var tt=S(Ne,2);{var at=C=>{var b=qt(),N=r(b),D=r(N,!0);a(N);var V=S(N,2),Se=r(V,!0);a(V),a(b),R(()=>{var xe,ke;H(D,(xe=l())==null?void 0:xe.word.zh),H(Se,(ke=l())==null?void 0:ke.word.pinyin)}),A(C,b)};oe(tt,C=>{var b;(b=o())!=null&&b.languages.chinese&&C(at)})}a(ge),a(fe);var Ge=S(fe,2);kt(Ge,5,()=>{var C;return(C=l())==null?void 0:C.forbidden},$t,(C,b,N)=>{var D=Qt(),V=r(D);let Se;var xe=r(V);{var ke=B=>{var U=Kt(),ie=r(U,!0);a(U),R(()=>H(ie,d(b).de)),A(B,U)};oe(xe,B=>{o().languages.german&&B(ke)})}var st=S(xe,2);{var nt=B=>{var U=Xt(),ie=r(U,!0);a(U),R(()=>H(ie,d(b).en)),A(B,U)};oe(st,B=>{o().languages.english&&B(nt)})}a(V);var rt=S(V,2);{var it=B=>{var U=Jt(),ie=r(U),ot=r(ie,!0);a(ie);var We=S(ie,2),lt=r(We,!0);a(We),a(U),R(()=>{H(ot,d(b).zh),H(lt,d(b).pinyin)}),A(B,U)};oe(rt,B=>{o().languages.chinese&&B(it)})}a(D),R(()=>{var B,U;Y(D,"background-color",((B=l())==null?void 0:B.categoryColor)+(N%2==0?"22":"44")),Y(D,"border-color",(U=l())==null?void 0:U.categoryColor),Se=K(V,1,"flex flex-col items-center justify-center",null,Se,{"w-full":o().languages.german||o().languages.english})}),A(C,D)}),a(Ge),a(me),a(Q),a(u),Le(u,C=>T(y,C),()=>d(y)),Tt(u,(C,b)=>Ae==null?void 0:Ae(C,b),()=>({delay:300})),Me(()=>Z("pandown",u,E)),Me(()=>Z("panup",u,j)),Me(()=>Z("panmove",u,c)),R(()=>{var C,b,N,D,V;G=K(u,1,"bg-white rounded-lg shadow-md p-4 py-5 shadow-slate-400 transform translate-x-0 select-none origin-bottom h-full w-full",null,G,{"pointer-events-none":!d($)}),Y(u,"--tw-translate-x",t().x+"px"),Y(u,"--tw-rotate",t().x/70+"deg"),Y(Q,"border-color",(C=l())==null?void 0:C.categoryColor),Y(W,"background-color",(b=l())==null?void 0:b.categoryColor),H(pe,(N=l())==null?void 0:N.category),Y(re,"border-color",(D=l())==null?void 0:D.categoryColor),H(De,d(f)),jt(ge,"style",`--border-color: ${((V=l())==null?void 0:V.categoryColor)??""}40`)}),A(g,u)},back:(g,ce)=>{var u=Zt();let G;var Q=r(u);let te;var W=r(Q),pe=r(W),re=S(r(pe)),De=r(re,!0);a(re),se(),a(pe);var me=S(pe,2),fe=S(r(me)),ge=r(fe,!0);a(fe),se(),a(me),a(W),a(Q),a(u),R(()=>{G=K(u,1,"rounded-lg shadow-md shadow-slate-400 back-card w-full h-full relative svelte-2jg59n",null,G,{"pointer-events-none":d($)}),te=K(Q,1,"h-full w-full absolute",null,te,{hidden:i().hasStarted}),H(De,i().oldPointsEarned),H(ge,k().currentTeam)}),A(g,u)}},$$legacy:!0}),g=>T(w,g),()=>d(w));var X=S(z,2);let J;var ee=r(X),de=r(ee,!0);a(ee),a(X),se(2),a(I),R(g=>{J=K(X,1,"absolute top-10 left-10 right-10 text-center p-5 rounded-full shadow-lg shadow-slate-600 text-white text-3xl opacity-0 pointer-events-none font-black tracking-widest uppercase",null,J,{"bg-slate-600":t().x<0,"bg-green-600":t().x>0}),Y(X,"opacity",g),H(de,t().x<0?"Skip":t().x>0?"Fine":" ")},[()=>(+(Math.abs(t().x)>h)*Math.abs(t().x)-h)/20],Ue),A(s,I),Ee(n,"drawnNewCard",_),Ee(n,"drawnNewCardClosed",P);var ne=Ce({drawnNewCard:_,drawnNewCardClosed:P});return v(),ne}var aa=L('<div><div class="flex flex-col h-full w-full select-none"><!> <!> <!></div></div>');function da(s,n){ye(n,!1);const[e,v]=Ie(),t=()=>O(q,"$roundState",e),i=()=>O(Oe,"$settings",e),o=()=>O(He,"$cardList",e),k=()=>O(Dt,"$allCards",e),l=()=>O(ve,"$gameState",e),f=()=>O(Xe,"$resetGameTriggered",e);Et(!0);let p=M(),m=M(),x=M(!1),h=M(!1);c();function y(){t().hasStarted&&(T(x,!0),setTimeout(()=>{T(x,!1)},200),ae(q,F(t).pointsEarned--,F(t)),ae(q,F(t).pointsEarned=Math.max(t().pointsEarned,0),F(t)),_())}function w(){t().totalSeconds<0||(ae(q,F(t).totalSeconds-=i().secondsPenaltyForSkip,F(t)),t().totalSeconds>0&&_())}function j(){t().hasStarted&&(T(h,!0),setTimeout(()=>{T(h,!1)},200),ae(q,F(t).pointsEarned++,F(t)),_())}function c(){we(He,Pt(k().filter(u=>!i().excludeCategories.includes(u.category)&&[i().difficulties.easy,i().difficulties.medium,i().difficulties.hard][u.difficulty-1])).map(u=>It(u,i()))),T(p,o()[0])}function E(){T(p,o()[l().currentCardIndex]),ae(ve,F(l).currentCardIndex+=1,F(l)),l().currentCardIndex>=o().length&&(ae(ve,F(l).currentCardIndex=0,F(l)),c())}async function _(){d(m)&&await d(m).drawnNewCard(),E()}async function P(){d(m)&&await d(m).drawnNewCardClosed(),E()}async function $(u){u.detail.type=="back"&&!t().hasStarted&&(await _(),we(q,Ft(t())))}let I=M(i().excludeCategories),z=M([i().difficulties.easy,i().difficulties.medium,i().difficulties.hard]),X=M(!1);ut(async()=>{setTimeout(()=>{T(X,!0)},10)}),le(()=>(i(),d(I),d(z),o()),()=>{(i().excludeCategories.join()!=d(I).join()||[i().difficulties.easy,i().difficulties.medium,i().difficulties.hard].join()!=d(z).join())&&(T(I,i().excludeCategories),T(z,[i().difficulties.easy,i().difficulties.medium,i().difficulties.hard]),console.log(d(z)),we(He,o().filter(u=>{let G=d(z)[u.difficulty-1];return!i().excludeCategories.includes(u.category)&&G})),E())}),le(()=>(t(),d(X)),()=>{!t().hasStarted&&d(X)&&P()}),le(()=>(f(),d(p)),()=>{f()&&((async()=>(c(),E()))(),console.log(d(p)),we(Xe,!1))}),Be(),be();var J=aa();let ee;var de=r(J),ne=r(de);zt(ne,{});var g=S(ne,2);Le(ta(g,{get currentCard(){return d(p)},$$events:{answerSkipped:w,answerFine:j,tapCard:$},$$legacy:!0}),u=>T(m,u),()=>d(m));var ce=S(g,2);At(ce,{$$events:{answerWrong:y,answerSkipped:w,answerFine:j}}),a(de),a(J),R(()=>ee=K(J,1,"flex h-full mx-auto max-w-md justify-center items-center transition-colors",null,ee,{"bg-red-400":d(x),"bg-green-400":d(h)})),A(s,J),Ce(),v()}export{da as component};
