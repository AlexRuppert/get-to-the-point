import{t as M,a as H,e as q,s as F}from"../chunks/B_ag6RmW.js";import{i as _e}from"../chunks/BLXaI5_v.js";import{G as rt,W as it,s as we,ax as Te,w as be,x as r,y as n,ay as re,z as y,F as $,az as xe,aA as Ae,v as B,aB as U,_ as Le,l as d,u as E,aC as ot,ad as Ie,e as Pe,ab as lt}from"../chunks/BvSNCPWU.js";import{r as N,S as he,m as dt,a as ct,b as vt,t as ut,s as ft,g as pt,c as G,d as de,e as mt,f as gt,i as xt,n as ht,h as _t,j as Be,k as Re,l as wt,o as Ge,p as Ce,q as Se,u as qe,v as bt,w as yt,x as Ct,y as St,z as kt,A as $t,B as Tt,C as De,D as jt,E as We,F as Et}from"../chunks/DKIBQUGH.js";import{b as He}from"../chunks/CiIBqmdd.js";import{i as ne,s as je,b as L,c as ge,d as Q,p as le}from"../chunks/B3tenwui.js";function V(a,s,t,m){var e=a.__styles??(a.__styles={});e[s]!==t&&(e[s]=t,t==null?a.style.removeProperty(s):a.style.setProperty(s,t,""))}function $e(a,s,t){var m=rt(a,s);m&&m.set&&(a[s]=t,it(()=>{a[s]=null}))}var It=M('<div class="bg-white font-semibold text-white w-full flex min-h-[3em] rounded-t-lg overflow-hidden" style="box-shadow: 0 -2px 8px #777;"><button type="button" class="bg-rose-600 w-1/3 items-center justify-items-center justify-center p-2 active:!text-error-700 active:bg-white flex space-x-2"><span class="w-5"><!></span> <span>WRONG</span></button> <button type="button" class="bg-slate-600 w-1/3 items-center justify-items-center justify-center p-2 active:!text-secondary-700 active:bg-white flex space-x-2"><span class="w-5"><!></span> <span>SKIP</span></button> <button type="button" class="bg-green-600 w-1/3 items-center justify-items-center justify-center p-2 active:!text-success-700 active:bg-white flex space-x-2"><span class="w-5"><!></span> <span>FINE</span></button></div>'),Pt=M('<div class="min-h-[3em]"><!></div>');function Dt(a,s){we(s,!1);const[t,m]=je(),e=()=>L(N,"$roundState",t),l=Te();function i(){l("answerWrong",{})}function S(){l("answerSkipped",{})}function o(){l("answerFine",{})}_e();var v=Pt(),u=r(v);{var f=p=>{var w=It(),b=r(w),T=r(b),c=r(T);he(c,{d:dt}),n(T),re(2),n(b);var C=y(b,2),g=r(C),k=r(g);he(k,{d:ct}),n(g),re(2),n(C);var I=y(C,2),D=r(I),A=r(D);he(A,{d:vt}),n(D),re(2),n(I),n(w),q("click",b,i),q("click",C,S),q("click",I,o),ut(3,w,()=>ft,()=>({axis:"x"})),H(p,w)},_=p=>{};ne(u,p=>{e().hasStarted?p(f):p(_,!1)})}n(v),H(a,v),be(),m()}var Ft=M('<div class="bg-white rounded-none font-semibold w-full shadow-lg flex justify-between rounded-b-lg"><button class="btn text-secondary-700 h-full px-3"><span class="w-5"><!></span></button> <div class="flex space-x-4 self-start"><div class="timer pt-2 flex flex-col -space-y-1 justify-items-center items-center space-x-1"><span class="small-caps text-xs">Time</span> <span> </span></div> <div class="flex flex-col -space-y-2.5 self-start pt-0.5"><div class="flex justify-items-center items-center space-x-1"><span class="w-12 text-xs small-caps">Team</span> <span class="text-xl tabular-nums"> </span></div> <div class="flex justify-items-center items-center space-x-1"><span class="w-12 text-xs small-caps">Points</span> <span class="text-2xl tabular-nums"> </span></div></div></div> <div class="py-1 px-3 flex flex-nowrap space-x-1"><button class="btn variant-ghost-primary px-2 font-medium rounded-lg"><span class="w-4 p-0"><!></span><span>Next Team</span></button></div></div>');function Ht(a,s){we(s,!1);const[t,m]=je(),e=()=>L(N,"$roundState",t),l=()=>L(Be,"$settings",t),i=()=>L(de,"$gameState",t),S=Te();let o=U(0),v=U(new Date("2999-12-12")),u=U(0);function f(){$(u,e().pointsEarned),ge(N,xt(l())),Q(N,E(e).oldPointsEarned=d(u),E(e)),Q(de,E(i).currentTeam=ht(i().currentTeam),E(i)),$(v,new Date)}function _(){const O={type:"component",component:"settingsModal"};_t.trigger(O)}setInterval(()=>{$(v,new Date)},200),xe(()=>(e(),d(o),d(v)),()=>{e().hasStarted?$(o,Math.min(e().totalSeconds,Math.max(e().totalSeconds-Math.floor((d(v).getTime()-e().startTime.getTime())/1e3),0))):$(o,e().totalSeconds),d(o)<=0&&(S("timeOut",{}),f())}),Ae(),_e();var p=Ft(),w=r(p),b=r(w),T=r(b);he(T,{d:mt}),n(b),n(w);var c=y(w,2),C=r(c),g=y(r(C),2);let k;var I=r(g,!0);n(g),n(C);var D=y(C,2),A=r(D),W=r(A),K=y(W,2),ie=r(K,!0);n(K),n(A);var ee=y(A,2),x=y(r(ee),2),ce=r(x,!0);n(x),n(ee),n(D),n(c);var h=y(c,2),X=r(h),Y=r(X),Z=r(Y);he(Z,{d:gt}),n(Y),re(),n(X),n(h),n(p),B(O=>{k=G(g,1,"text-2xl tabular-nums w-[3ch] text-right",null,k,{"text-red-700":+d(o)<11}),F(I,d(o)),V(W,"color",O),V(K,"color",O),F(ie,i().currentTeam),F(ce,e().hasStarted?e().pointsEarned:d(u))},[()=>pt(i().currentTeam)],Le),q("click",w,_),q("click",X,f),H(a,p),be(),m()}const Mt=300,Ke="none";function me(a,s,t){return a.addEventListener(s,t),()=>a.removeEventListener(s,t)}function At(a,s){return s.filter(t=>a.pointerId!==t.pointerId)}function ke(a,s,t,m,e){a.dispatchEvent(new CustomEvent(`${s}${e}`,{detail:{event:t,pointersCount:m.length,target:t.target}}))}function Lt(a,s,t,m,e,l=Ke){s.style.touchAction=l;let i=[];function S(v){i.push(v),ke(s,a,v,i,"down"),m==null||m(i,v);const u=v.pointerId;function f(c){u===c.pointerId&&(i=At(c,i),i.length||_(),ke(s,a,c,i,"up"))}function _(){p(),w(),b(),T()}const p=me(s,"pointermove",c=>{i=i.map(C=>c.pointerId===C.pointerId?c:C),ke(s,a,c,i,"move"),t==null||t(i,c)}),w=me(s,"lostpointercapture",c=>{f(c)}),b=me(s,"pointerup",c=>{f(c)}),T=me(s,"pointerleave",c=>{i=[],_(),ke(s,a,c,i,"up")})}const o=me(s,"pointerdown",S);return{destroy:()=>{o()}}}function Fe(a,s){let t={delay:Mt,composed:!1,touchAction:Ke,...s};const m="pan";let e,l;function i(o,v){e=Date.now(),l=v.target}function S(o,v){if(o.length===1&&Date.now()-e>t.delay){const u=a.getBoundingClientRect(),f=Math.round(v.clientX-u.left),_=Math.round(v.clientY-u.top);f>=0&&_>=0&&f<=u.width&&_<=u.height&&a.dispatchEvent(new CustomEvent(m,{detail:{x:f,y:_,target:l}}))}return!1}return t.composed?{onMove:S,onDown:i,onUp:null}:{...Lt(m,a,S,i,null,t.touchAction),update:o=>{t={...t,...o}}}}function Ye(a){return Object.prototype.toString.call(a)==="[object Date]"}function Me(a,s,t,m){if(typeof t=="number"||Ye(t)){const e=m-t,l=(t-s)/(a.dt||1/60),i=a.opts.stiffness*e,S=a.opts.damping*l,o=(i-S)*a.inv_mass,v=(l+o)*a.dt;return Math.abs(v)<a.opts.precision&&Math.abs(e)<a.opts.precision?m:(a.settled=!1,Ye(t)?new Date(t.getTime()+v):t+v)}else{if(Array.isArray(t))return t.map((e,l)=>Me(a,s[l],t[l],m[l]));if(typeof t=="object"){const e={};for(const l in t)e[l]=Me(a,s[l],t[l],m[l]);return e}else throw new Error(`Cannot spring ${typeof t} values`)}}function Bt(a,s={}){const t=ot(a),{stiffness:m=.15,damping:e=.8,precision:l=.01}=s;let i,S,o,v=a,u=a,f=1,_=0,p=!1;function w(T,c={}){u=T;const C=o={};return a==null||c.hard||b.stiffness>=1&&b.damping>=1?(p=!0,i=Re.now(),v=T,t.set(a=u),Promise.resolve()):(c.soft&&(_=1/((c.soft===!0?.5:+c.soft)*60),f=0),S||(i=Re.now(),p=!1,S=wt(g=>{if(p)return p=!1,S=null,!1;f=Math.min(f+_,1);const k=Math.min(g-i,1e3/30),I={inv_mass:f,opts:b,settled:!0,dt:k*60/1e3},D=Me(I,v,a,u);return i=g,v=a,t.set(a=D),I.settled&&(S=null),!I.settled})),new Promise(g=>{S.promise.then(()=>{C===o&&g()})}))}const b={set:w,update:(T,c)=>w(T(u,a),c),subscribe:t.subscribe,stiffness:m,damping:e,precision:l};return b}var Ut=M("<div><div><div><!></div> <div><!></div></div></div>");function Nt(a,s){we(s,!1);let t=le(s,"containerCardClass",8,""),m=le(s,"containerCardInnerClass",8,""),e=le(s,"frontCardClass",8,""),l=le(s,"backCardClass",8,""),i=le(s,"isUp",12,!1);const S=Te();let o=U(!0);async function v(){return new Promise(async(g,k)=>{$(o,!1),await Ie(),i(!1),await Ie(),setTimeout(()=>{$(o,!0),i(!0),g()},10)})}async function u(){return new Promise(async(g,k)=>{i()&&(i(!1),await Ie())})}function f(g){S("tapCard",{type:i()?"front":"back"})}_e();var _=Ut(),p=r(_);let w;var b=r(p),T=r(b);Ge(T,s,"front",{},null),n(b);var c=y(b,2),C=r(c);return Ge(C,s,"back",{},null),n(c),n(p),n(_),B((g,k,I,D)=>{G(_,1,Se(g),"svelte-1fd8m2h"),w=G(p,1,Se(k),"svelte-1fd8m2h",w,{enableTransition:d(o),flipped:!i()}),G(b,1,Se(I),"svelte-1fd8m2h"),G(c,1,Se(D),"svelte-1fd8m2h")},[()=>Ce(t(),"container-card drop-shadow-md"),()=>Ce(m(),"container-card-inner relative w-full h-full transform"),()=>Ce(e(),"front-card  w-full h-full backface-invisible"),()=>Ce(l(),"back-card absolute inset-0 backface-invisible")],Le),q("pointerdown",p,f),q("click",_,function(g){qe.call(this,s,g)}),H(a,_),$e(s,"flipFromBack",v),$e(s,"flipToBack",u),be({flipFromBack:v,flipToBack:u})}var Ot=M('<div class="py-2 font-medium text-center text-xl svelte-2jg59n"> </div>'),zt=M('<div class="py-2 font-medium text-center text-xl svelte-2jg59n"> </div>'),Rt=M('<div class="svelte-2jg59n"><div class="text-center text-2xl"> </div> <div class="-mt-1 text-center text-sm"> </div></div>'),Gt=M('<div class="text-center text-md"> </div>'),Wt=M('<div class="text-center text-md"> </div>'),Yt=M('<div class="w-full self-center"><div class="text-center text-xl"> </div> <div class="-mt-1 text-center text-xs"> </div></div>'),qt=M('<div class="flex align-middle justify-center p-0 min-h-[2em] max-h-[6em] h-full"><div><!> <!></div> <!></div>'),Kt=M('<div slot="front"><div class="rounded-md border-2 relative h-full"><div class="flex w-full -top-4 left-0 absolute justify-center"><div class="rounded-full font-medium text-white text-sm tracking-wider py-1 px-2 capitalize"> </div></div> <div class="flex flex-col h-full"><div class="flex basis-0 flex-col space-y-2 w-full h-full min-h-[8em] my-4 target-word items-center justify-center tracking-wider leading-4"><div class="w-full target-words svelte-2jg59n"><!> <!> <!></div></div> <div class="forbidden-words grow tracking-wider leading-4 h-full flex flex-col"></div></div></div></div>'),Xt=M('<div slot="back"><div><div class="h-full w-full grid place-items-center text-secondary-800"><div class="bg-white/50 text-4xl p-4 rounded-lg self-center font-bold">You scored <span class="font-black text-red-800"> </span> points!</div> <div class="bg-white/50 text-4xl p-4 rounded-lg self-center font-bold">Team <span class="font-black text-red-800"> </span>s turn!</div></div></div></div>'),Jt=M('<div class="grow relative"><!> <div><span class="whitespace-pre"> </span></div> <div class="bg-white rounded-lg shadow-sm p-4 pt-6 shadow-slate-500 transform translate-x-0 select-none origin-bottom absolute inset-3 -z-10 back-card svelte-2jg59n"></div></div>');function Qt(a,s){we(s,!1);const[t,m]=je(),e=()=>L(f,"$cardTouchDelta",t),l=()=>L(N,"$roundState",t),i=()=>L(Be,"$settings",t),S=()=>L(de,"$gameState",t);let o=le(s,"currentCard",8);const v=Te(),u={start:{x:0,y:0}},f=Bt({x:0,y:0}),_=60;let p=U(),w=U();function b(x){d(p).releasePointerCapture(x.detail.event.pointerId),Math.abs(e().x)>_?(e().x<0&&v("answerSkipped",{}),e().x>0&&v("answerFine",{}),f.set({x:0,y:0},{hard:!0})):f.set({x:0,y:0})}function T(x){f.set({x:x.detail.event.x-u.start.x,y:x.detail.event.y-u.start.y})}function c(x){l().hasStarted&&(d(p).setPointerCapture(x.detail.event.pointerId),u.start={x:x.detail.event.x,y:x.detail.event.y})}async function C(){return d(w).flipFromBack()}async function g(){var x;return(x=d(w))==null?void 0:x.flipToBack()}let k=U(!1);xe(()=>(d(k),l()),()=>{!d(k)&&!l().hasStarted&&g()}),Ae(),_e();var I=Jt(),D=r(I);He(Nt(D,{containerCardClass:"absolute inset-3",get isUp(){return d(k)},set isUp(x){$(k,x)},$$events:{tapCard(x){qe.call(this,s,x)}},$$slots:{front:(x,ce)=>{var h=Kt();let X;var Y=r(h),Z=r(Y),O=r(Z),ve=r(O,!0);n(O),n(Z);var ue=y(Z,2),fe=r(ue),oe=r(fe),pe=r(oe);{var Ee=P=>{var j=Ot(),J=r(j,!0);n(j),B(()=>F(J,o().target.german)),H(P,j)};ne(pe,P=>{i().languages.german&&P(Ee)})}var Ue=y(pe,2);{var Xe=P=>{var j=zt(),J=r(j,!0);n(j),B(()=>F(J,o().target.english)),H(P,j)};ne(Ue,P=>{i().languages.english&&P(Xe)})}var Je=y(Ue,2);{var Qe=P=>{var j=Rt(),J=r(j),te=r(J,!0);n(J);var ae=y(J,2),ye=r(ae,!0);n(ae),n(j),B(()=>{F(te,o().target.chinese),F(ye,o().target.pinyin)}),H(P,j)};ne(Je,P=>{i().languages.chinese&&P(Qe)})}n(oe),n(fe);var Ne=y(fe,2);bt(Ne,5,()=>o().forbidden,yt,(P,j,J)=>{var te=qt(),ae=r(te);let ye;var Oe=r(ae);{var Ve=z=>{var R=Gt(),se=r(R,!0);n(R),B(()=>F(se,d(j).german)),H(z,R)};ne(Oe,z=>{i().languages.german&&z(Ve)})}var Ze=y(Oe,2);{var et=z=>{var R=Wt(),se=r(R,!0);n(R),B(()=>F(se,d(j).english)),H(z,R)};ne(Ze,z=>{i().languages.english&&z(et)})}n(ae);var tt=y(ae,2);{var at=z=>{var R=Yt(),se=r(R),st=r(se,!0);n(se);var ze=y(se,2),nt=r(ze,!0);n(ze),n(R),B(()=>{F(st,d(j).chinese),F(nt,d(j).pinyin)}),H(z,R)};ne(tt,z=>{i().languages.chinese&&z(at)})}n(te),B(()=>{V(te,"background-color",o().categoryColor+(J%2==0?"22":"44")),V(te,"border-color",o().categoryColor),ye=G(ae,1,"flex flex-col items-center justify-center",null,ye,{"w-full":i().languages.german||i().languages.english})}),H(P,te)}),n(Ne),n(ue),n(Y),n(h),He(h,P=>$(p,P),()=>d(p)),Ct(h,(P,j)=>Fe==null?void 0:Fe(P,j),()=>({delay:300})),Pe(()=>q("pandown",h,c)),Pe(()=>q("panup",h,b)),Pe(()=>q("panmove",h,T)),B(()=>{X=G(h,1,"bg-white rounded-lg shadow-md p-4 py-5 shadow-slate-400 transform translate-x-0 select-none origin-bottom h-full w-full",null,X,{"pointer-events-none":!d(k)}),V(h,"--tw-translate-x",e().x+"px"),V(h,"--tw-rotate",e().x/70+"deg"),V(Y,"border-color",o().categoryColor),V(O,"background-color",o().categoryColor),F(ve,o().category),St(oe,"style",`--border-color: ${o().categoryColor??""}40`)}),H(x,h)},back:(x,ce)=>{var h=Xt();let X;var Y=r(h);let Z;var O=r(Y),ve=r(O),ue=y(r(ve)),fe=r(ue,!0);n(ue),re(),n(ve);var oe=y(ve,2),pe=y(r(oe)),Ee=r(pe,!0);n(pe),re(),n(oe),n(O),n(Y),n(h),B(()=>{X=G(h,1,"rounded-lg shadow-md shadow-slate-400 back-card w-full h-full relative svelte-2jg59n",null,X,{"pointer-events-none":d(k)}),Z=G(Y,1,"h-full w-full absolute",null,Z,{hidden:l().hasStarted}),F(fe,l().oldPointsEarned),F(Ee,S().currentTeam)}),H(x,h)}},$$legacy:!0}),x=>$(w,x),()=>d(w));var A=y(D,2);let W;var K=r(A),ie=r(K,!0);n(K),n(A),re(2),n(I),B(x=>{W=G(A,1,"absolute top-10 left-10 right-10 text-center p-1 rounded-full text-white text-xl opacity-0 pointer-events-none",null,W,{"bg-secondary-500":e().x<0,"bg-success-500":e().x>0}),V(A,"opacity",x),F(ie,e().x<0?"Skip":e().x>0?"Fine":" ")},[()=>(+(Math.abs(e().x)>_)*Math.abs(e().x)-_)/20],Le),H(a,I),$e(s,"drawnNewCard",C),$e(s,"drawnNewCardClosed",g);var ee=be({drawnNewCard:C,drawnNewCardClosed:g});return m(),ee}var Vt=M('<div><div class="flex flex-col h-full w-full select-none"><!> <!> <!></div></div>');function ra(a,s){we(s,!1);const[t,m]=je(),e=()=>L(N,"$roundState",t),l=()=>L(Be,"$settings",t),i=()=>L(De,"$cardList",t),S=()=>L(jt,"$allCards",t),o=()=>L(de,"$gameState",t),v=()=>L(We,"$resetGameTriggered",t);kt(!0);let u=U(),f=U(),_=U(!1),p=U(!1);c();function w(){e().hasStarted&&($(_,!0),setTimeout(()=>{$(_,!1)},200),Q(N,E(e).pointsEarned--,E(e)),Q(N,E(e).pointsEarned=Math.max(e().pointsEarned,0),E(e)),g())}function b(){e().hasStarted&&(Q(N,E(e).totalSeconds-=l().secondsPenaltyForSkip,E(e)),e().totalSeconds<0&&Q(N,E(e).totalSeconds=0,E(e)),g())}function T(){e().hasStarted&&($(p,!0),setTimeout(()=>{$(p,!1)},200),Q(N,E(e).pointsEarned++,E(e)),g())}function c(){ge(De,$t(S().filter(h=>!l().excludeCategories.includes(h.category))).map(h=>Tt(h,l()))),$(u,i()[0])}function C(){$(u,i()[o().currentCardIndex]),Q(de,E(o).currentCardIndex+=1,E(o)),o().currentCardIndex>=i().length&&(Q(de,E(o).currentCardIndex=0,E(o)),c())}async function g(){d(f)&&await d(f).drawnNewCard(),C()}async function k(){d(f)&&await d(f).drawnNewCardClosed(),C()}async function I(h){h.detail.type=="back"&&!e().hasStarted&&(await g(),ge(N,Et(e())))}let D=U(l().excludeCategories),A=U(!1);lt(async()=>{setTimeout(()=>{$(A,!0)},10)}),xe(()=>(l(),d(D),i()),()=>{l().excludeCategories.join()!=d(D).join()&&($(D,l().excludeCategories),ge(De,i().filter(h=>!l().excludeCategories.includes(h.category))),C())}),xe(()=>(e(),d(A)),()=>{!e().hasStarted&&d(A)&&k()}),xe(()=>(v(),d(u)),()=>{v()&&(console.log("trigg"),(async()=>(c(),C()))(),console.log(d(u)),ge(We,!1))}),Ae(),_e();var W=Vt();let K;var ie=r(W),ee=r(ie);Ht(ee,{});var x=y(ee,2);He(Qt(x,{get currentCard(){return d(u)},$$events:{answerSkipped:b,answerFine:T,tapCard:I},$$legacy:!0}),h=>$(f,h),()=>d(f));var ce=y(x,2);Dt(ce,{$$events:{answerWrong:w,answerSkipped:b,answerFine:T}}),n(ie),n(W),B(()=>K=G(W,1,"flex h-full mx-auto max-w-md justify-center items-center transition-colors",null,K,{"bg-red-400":d(_),"bg-green-400":d(p)})),H(a,W),be(),m()}export{ra as component};
